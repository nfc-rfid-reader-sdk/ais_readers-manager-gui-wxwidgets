#include <iostream>
#include "ais_readers.h"
#include "ais_readers_list.h"
#include "dl_status.h"
#include <string>
#include <cstring>
#include <string.h>
#include <sstream>
#include <time.h>
#include <iostream>
#include <fstream>
#include <ctype.h>
#include <vector>
#include <map>
#include "curl.h"


using namespace std;

//--------------------------------------------------------------------------------------------
void PrepareSettings(void);
//--------------------------------------------------------------------------------------------
void AppLoop(void);
//--------------------------------------------------------------------------------------------
void OpenAllDevicesAndReadLists(void);
//--------------------------------------------------------------------------------------------
void SendAllLogs(void);
//--------------------------------------------------------------------------------------------
void SendRealTimeEvent(void);
//--------------------------------------------------------------------------------------------
size_t WriteCallback(void *contents, size_t size, size_t nmemb, void *userp);
//--------------------------------------------------------------------------------------------
string ReadWhitelistFromDB(int R_ID);
//--------------------------------------------------------------------------------------------
c_string ReadWhitelistFromReader(HND_AIS handle);
//--------------------------------------------------------------------------------------------
DL_STATUS WriteWhitelistToReader(HND_AIS handle, c_string str_whitelist);
//--------------------------------------------------------------------------------------------
string ReadBlacklistFromDB(int R_ID);
//--------------------------------------------------------------------------------------------
c_string ReadBlacklistFromReader(HND_AIS handle);
//--------------------------------------------------------------------------------------------
void WriteBlacklistToReader(HND_AIS handle, c_string str_blacklist);
//--------------------------------------------------------------------------------------------
void print_hex(const uint8_t *data, uint32_t len, const char *delimiter);
//--------------------------------------------------------------------------------------------
void PrintRealTimeEventTable(void);
//--------------------------------------------------------------------------------------------
string PrepareFilename();
//--------------------------------------------------------------------------------------------
string ReadWholeWhitelistDatabase();
//--------------------------------------------------------------------------------------------
string ReadWholeBlacklistDatabase();
//--------------------------------------------------------------------------------------------
void WriteChangesToFile();
//--------------------------------------------------------------------------------------------
void SetDevicesTime(HND_AIS handle, int DevID);
//--------------------------------------------------------------------------------------------
void SetDevicesTimeManual(HND_AIS handle, int DevID);
//--------------------------------------------------------------------------------------------
string GetGMTTimeFromInternet();
//--------------------------------------------------------------------------------------------
void GetDevicesTime(HND_AIS handle, int DevID);
//--------------------------------------------------------------------------------------------
void menu(char key);
//--------------------------------------------------------------------------------------------
void usage(void);
//--------------------------------------------------------------------------------------------
void GetLogs(void);
//--------------------------------------------------------------------------------------------
void Operation1(void);
//--------------------------------------------------------------------------------------------
void Operation2(void);
//--------------------------------------------------------------------------------------------
void Operation3(void);
//--------------------------------------------------------------------------------------------
void Operation4(void);
//--------------------------------------------------------------------------------------------
void Operation5(void);
//--------------------------------------------------------------------------------------------
void PrintLogs(int log_index, int log_action, int log_reader_id, int log_card_id,
               int log_system_id, uint8_t nfc_uid[10],
               int nfc_uid_len, uint64_t timestamp, char log_type);
//--------------------------------------------------------------------------------------------
void GetLogsByIndex();
//--------------------------------------------------------------------------------------------
unsigned long StringToTimestamp(string datetime);
//--------------------------------------------------------------------------------------------
void GetLogsByTime();
//--------------------------------------------------------------------------------------------
uint32_t GetTimeZone();
//--------------------------------------------------------------------------------------------
string SendUnreadLogToDatabase(string data_to_send);
//--------------------------------------------------------------------------------------------
void SendRealTimeEventToDatabase(string data_to_send);
//--------------------------------------------------------------------------------------------
void OpenDebugLog();
//--------------------------------------------------------------------------------------------
void CloseDebugLog();
//--------------------------------------------------------------------------------------------


